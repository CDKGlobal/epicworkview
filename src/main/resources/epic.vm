<html>
  <head>
    <title>My Epic</title>
    <meta name="decorator" content="atl.general">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
    $webResourceManager.requireResource("com.teamepic.plugin.EpicPlugin:EpicPlugin-resources")
  </head>
  <body>
    <div class="content-container content-body">
	    <table ng-app ng-controller="ProjectController" ng-click="hideEpicInfo()" id="projects" class="aui">
	      <thead>
	        <tr>
	          <th>
	          	<span class="fieldLabel">Projects</span>
	          	<span ng-click="toggleFilter($event)" class="criteria-selector aui-button aui-button-subtle drop-arrow">
	          		filter
	          	</span>
	          	<div ng-show="filter" ng-click="$event.stopPropagation()" class="project-filter">
			    	<form action="#" class="searchfilter aui top-label aui-popup-content project-criteria">
			    		<input type='text' ng-model='searchText' autocomplete="off" placeholder="Find Projects..." class="aui-field" wrap="off">
			    		<div class="aui-list-scroll">
			    			<ul class="aui-list-section">
			    				<li ng-repeat="project in projects | filter:searchText" class="check-list-item">
			    					<label class="item-label" title="{{project.name}}">
			    						<input type="checkbox" ng-init="project.included=true" ng-model='project.included' tabindex="-1" value="13198">
			    						{{project.name}}
			    					</label>
			    				</li>
			    			</ul>
			    		</div>
			    	</form>
			    </div>
	          </th>
	          <th>Project Id</th>
	          <th>Project Key</th>
	          <th>Project Description</th>
	          <th>Epics</th>
	        </tr>
	      </thead>
	      <tbody>
	      	<tr ng-repeat="project in projects | filter: {included:true}">
	      		<td><a href="/jira/browse/{{project.key}}">{{project.name}}</a></td>
	      		<td>{{project.id}}</td>
	      		<td>{{project.key}}</td>
	      		<td>{{project.description}}</td>
	      		<td>
	      			<ul class="epics" ng-controller="EpicController">
	      				<li class="inline" ng-repeat="epic in project.epics">
	      					<a href="#" ng-class="{'clicked-epic': isClicked(epic.id)}" class="epic" ng-click="toggleEpic($event, epic.id)">
	      						{{epic.name}}
	      					</a>
	      					<div class="epic-info" ng-show="isClicked(epic.id)">
	      						<p>{{epic.description}}</p>
	      					</div>
	      				</li>
	      			</ul>
	      		</td>
	      	</tr>
	      </tbody>
    	</table>
    </div>
  </body>
</html>
